# AAHYWEH
# Control file for choosing data from the L1 Excel spreadsheet and writing it to a netCDF file.
#
# [General] - python control parameters
# [Files] - contains paths, file names and location of data in file
# [Global] - global attributes to be written into the netCDF file
# [Variables] - data to extract from Excel spreadsheet and write to netCDF file
#
[General]
InLevel = L1
OutLevel = L1
Platform = PC    # Mac or PC

[Files]
    [[L1]]
        xlFilePath = /Volumes/EcoHydro/TERN-OzFlux/Craig Macfarlane/							    # path to Excel file
        xlFileName = Gingin_0332012.xls               				    # xl file name
        xlHeaderRow  = 2                                                       # row number of header row in xl file
        xl1stDataRow = 5                                                       # row number of first data row in xl file
        ncFilePath = /Volumes/EcoHydro/TERN-OzFlux/Craig Macfarlane/               					# path to netCDF file
        ncFileName = Gingin_0332012_L1.nc                                       # nc file name

[Global]                                                                       # Global attributes for netCDF file
    SiteName = Gingin                                                    	    # Site name (no spaces) *required
    Site = "Gingin, Western Australia"                					# Site description *required
    Location = "Latitude: -31.375, Longitude: 115.65"                                 # Latitude and Longitude *required
    Institute = "CSIRO"                                     				  # Institute running site
    Contact  = mac508@csiro.au                                                 # email address for contact *required
    TimeStep = 30                                                              # Timestep in minutes

[Variables]
# Date/time
    [[xlDateTime]]                                                             # netCDF variable name
        [[[xl]]]                                                               # Excel information section
            Sheet    = Data                                                # worksheet containing data
            Name     = TIMESTAMP                                               # name in Excel header row
        [[[Attr]]]                                                             # netCDF variable attribute section
            Description = "Date/time in Excel format"                          # variable attribute - description
            Units    = "days"                                                  # variable attribute - units
# Radiation: Kipp and Zonen CNR4
    [[Flu]]
        [[[xl]]]
            Sheet    = Data
            Name     = CG3DownCor_Avg
        [[[Attr]]]
            Description = "Up-welling long wave (Kipp&Zonen)"
            Units    = "W/m2"
    [[Fld]]
        [[[xl]]]
            Sheet    = Data
            Name     = CG3UpCor_Avg
        [[[Attr]]]
            Description = "Down-welling long wave (Kipp&Zonen)"
            Units    = "W/m2"
    [[Fsu]]
        [[[xl]]]
            Sheet    = Data
            Name     = CM3Down_Avg
        [[[Attr]]]
            Description = "Up-welling short wave (Kipp&Zonen)"
            Units    = "W/m2"
    [[Fsd]]
        [[[xl]]]
            Sheet    = Data
            Name     = CM3Up_Avg
        [[[Attr]]]
            Description = "Down-welling short wave (Kipp&Zonen)"
            Units    = "W/m2"
# Covariances: Temperature
    [[UzT]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_Ts_Uz
        [[[Attr]]]
            Description = "Covariance of Uz and T (CSAT)"
            Units    = "mC/s"
    [[UxT]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_Ts_Ux
        [[[Attr]]]
            Description = "Covariance of Ux and T (CSAT)"
            Units    = "mC/s"
    [[UyT]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_Ts_Uy
        [[[Attr]]]
            Description = "Covariance of Uy and T (CSAT)"
            Units    = "mC/s"
# Covariances: H2O
    [[UzA]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_h2o_Uz
        [[[Attr]]]
            Description = "Covariance of w and H2O (7500)"
            Units    = "g/m2/s"
    [[UxA]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_h2o_Ux
        [[[Attr]]]
            Description = "Covariance of Ux and H2O (7500)"
            Units    = "g/m2/s"
    [[UyA]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_h2o_Uy
        [[[Attr]]]
            Description = "Covariance of Uy and H2O (7500)"
            Units    = "g/m2/s"
# Covariances: CO2
    [[UzC]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_co2_Uz
        [[[Attr]]]
            Description = "Covariance of Uz and CO2 (7500)"
            Units    = "mg/m2/s"
    [[UxC]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_co2_Ux
        [[[Attr]]]
            Description = "Covariance of Ux and CO2 (7500)"
            Units    = "mg/m2/s"
    [[UyC]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_co2_Uy
        [[[Attr]]]
            Description = "Covariance of Uy and CO2 (7500)"
            Units    = "mg/m2/s"
# Covariances and variances: Momentum
    [[UxUz]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_Ux_Uz
        [[[Attr]]]
            Description = "Covariance of Ux and Uz"
            Units    = "m2/s2"
    [[UyUz]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_Uy_Uz
        [[[Attr]]]
            Description = "Covariance of Uy and Uz"
            Units    = "m2/s2"
    [[UxUy]]
        [[[xl]]]
            Sheet    = Data
            Name     = cov_Ux_Uy
        [[[Attr]]]
            Description = "Covariance of Ux and Uz"
            Units    = "m2/s2"
    [[Ux_Sd]]
        [[[xl]]]
            Sheet    = Data
            Name     = stdev_Ux
        [[[Attr]]]
            Description = "Std dev of Ux"
            Units    = "m/s"

    [[UxUx]]
        [[[Function]]]
            [[[[0]]]]
                [[[[[Square]]]]]
                    Parent = Ux_Sd
        [[[Attr]]]
            Description = "Variance of Ux"
            Units    = "m2/s2"

    [[Uy_Sd]]
        [[[xl]]]
            Sheet    = Data
            Name     = stdev_Uy
        [[[Attr]]]
            Description = "Std dev of Uy"
            Units    = "m/s"

    [[UyUy]]
        [[[Function]]]
            [[[[0]]]]
                [[[[[Square]]]]]
                    Parent = Uy_Sd
        [[[Attr]]]
            Description = "Variance of Uy"
            Units    = "m2/s2"

# Meteorology: CSAT
    [[Tv_CSAT]]
        [[[xl]]]
            Sheet    = Data
            Name     = Ts_mean
        [[[Attr]]]
            Description = "Virtual air temperature (CSAT)"
            Units    = "C"
    [[Wd_CSAT_Compass]]
        [[[xl]]]
            Sheet    = Data
            Name     = wnd_dir_compass
        [[[Attr]]]
            Description = "Wind direction (CSAT)"
            Units    = "deg"
    [[Ws_CSAT]]
        [[[xl]]]
            Sheet    = Data
            Name     = wnd_spd
        [[[Attr]]]
            Description = "Wind speed (CSAT)"
            Units    = "m/s"
    [[Ux]]
        [[[xl]]]
            Sheet    = Data
            Name     = Ux_Avg
        [[[Attr]]]
            Description = "Ux (CSAT)"
            Units    = "m/s"
    [[Uy]]
        [[[xl]]]
            Sheet    = Data
            Name     = Uy_Avg
        [[[Attr]]]
            Description = "Uy (CSAT)"
            Units    = "m/s"
    [[Uz]]
        [[[xl]]]
            Sheet    = Data
            Name     = Uz_Avg
        [[[Attr]]]
            Description = "Uz (CSAT)"
            Units    = "m/s"
    [[Diag_CSAT]]
        [[[xl]]]
            Sheet    = Data
            Name     = csat_warnings
        [[[Attr]]]
            Description = "CSAT diagnostic value"
            Units    = "none"
# Meteorology: LI-7500
    [[Ah_7500_Av]]
        [[[xl]]]
            Sheet    = Data
            Name     = h2o_Avg
        [[[Attr]]]
            Description = "Absolute humidity (7500)"
            Units    = "g/m3"
    [[Cc_7500_Av]]
        [[[xl]]]
            Sheet    = Data
            Name     = co2_mean
        [[[Attr]]]
            Description = "CO2 concentration (7500)"
            Units    = "mg/m3"
    [[Ah_7500_Sd]]
        [[[xl]]]
            Sheet    = Data
            Name     = stdev_h2o
        [[[Attr]]]
            Description = "Absolute humidity (7500), standard deviation"
            Units    = "g/m3"
    [[AhAh]]
        [[[Function]]]
            [[[[0]]]]
                [[[[[Square]]]]]
                    Parent = Ah_7500_Sd
        [[[Attr]]]
            Description = "Absolute humidity (7500), variance"
            Units    = "(g/m3)2"
    [[Cc_7500_Sd]]
        [[[xl]]]
            Sheet    = Data
            Name     = stdev_co2
        [[[Attr]]]
            Description = "CO2 concentration (7500), standard deviation"
            Units    = "mg/m3"
    [[CcCc]]
        [[[Function]]]
            [[[[0]]]]
                [[[[[Square]]]]]
                    Parent = Cc_7500_Sd
        [[[Attr]]]
            Description = "CO2 concentration (7500), variance"
            Units    = "(mg/m3)2"
    [[ps]]
        [[[xl]]]
            Sheet    = Data
            Name     = press_mean
        [[[Attr]]]
            Description = "Static pressure"
            Units    = "kPa"
    [[Diag_7500]]
        [[[xl]]]
            Sheet    = Data
            Name     = irga_warnings
        [[[Attr]]]
            Description = "7500 diagnostic value"
            Units    = "none"
    [[AGC_7500]]
        [[[xl]]]
            Sheet    = Data
            Name     = agc_Avg
        [[[Attr]]]
            Description = "7500 AGC"
            Units    = "none"
# Meteorology: HMP45c
    [[Ah_HMP_01]]
        # Python QC expects one HMP to be labelled HMP_01
        [[[xl]]]
            Sheet    = Data
            Name     = h2o_hmp_mean
        [[[Attr]]]
            Description = "Absolute humidity (HMP) at EC height"
            Units    = "g/m3"
    [[Ta_HMP_01]]
        # Python QC expects one HMP to be labelled HMP_01
        [[[xl]]]
            Sheet    = Data
            Name     = t_hmp_mean
        [[[Attr]]]
            Description = "Air temperature (HMP) at EC height"
            Units    = "C"
# Meteorology: RMYoung
    [[Ws_RMY_10m]]
        [[[xl]]]
            Sheet    = Data
            Name     = Wind_speed
        [[[Attr]]]
            Description = "Wind speed (RMY) at 15m"
            Units    = "m/s"
    [[Wd_RMY_10m]]
        [[[xl]]]
            Sheet    = Data
            Name     = Wind_dir
        [[[Attr]]]
            Description = "Wind direction (RMY) at 15m"
            Units    = "deg"
# Meteorology: Rain
    [[Rain]]
        [[[xl]]]
            Sheet    = Data
            Name     = Rainfall_Tot
        [[[Attr]]]
            Description = "Rainfall"
            Units    = "mm"
# Soil: Ground heat flux
    [[Fg_01]]
        [[[xl]]]
            Sheet    = Data
            Name     = shf_Avg(1)
        [[[Attr]]]
            Description = "Ground heat flux"
            Units    = "W/m2"
    [[Fg_02]]
        [[[xl]]]
            Sheet    = Data
            Name     = shf_Avg(2)
        [[[Attr]]]
            Description = "Ground heat flux"
            Units    = "W/m2"
    [[Fg_03]]
        [[[xl]]]
            Sheet    = Data
            Name     = shf_Avg(3)
        [[[Attr]]]
            Description = "Ground heat flux"
            Units    = "W/m2"
# Soil: Soil moisture
    [[Sws_01]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(1,1)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_02]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(1,2)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_03]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(2,1)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_04]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(2,2)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_05]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(3,1)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_06]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(3,2)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_07]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(4,1)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_08]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(4,2)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_09]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(5,1)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_10]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(5,2)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_11]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(6,1)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_12]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(6,2)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_13]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(7,1)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_14]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(7,2)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_15]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(8,1)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_16]]
        [[[xl]]]
            Sheet    = Data
            Name     = "soil_water_T_Avg(8,2)"
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
# Soil: Soil temperature
    [[Ts_01]]
        [[[xl]]]
            Sheet    = Data
            Name     = Tsoil_avg(1)
        [[[Attr]]]
            Description = "Soil temperature"
            Units    = "C"
    [[Ts_02]]
        [[[xl]]]
            Sheet    = Data
            Name     = Tsoil_avg(2)
        [[[Attr]]]
            Description = "Soil temperature"
            Units    = "C"
    [[Ts_03]]
        [[[xl]]]
            Sheet    = Data
            Name     = Tsoil_avg(2)
        [[[Attr]]]
            Description = "Soil temperature"
            Units    = "C"
# Housekeeping
    [[Vbat]]
        [[[xl]]]
            Sheet    = Data
            Name     = batt_volt_Avg
        [[[Attr]]]
            Description = "Battery voltage"
            Units    = "V"
    [[Tpanel]]
        [[[xl]]]
            Sheet    = Data
            Name     = panel_temp_Avg
        [[[Attr]]]
            Description = "Panel temperature"
            Units    = "C"

