# AAHYWEH
# Control file for choosing data from the L1 Excel spreadsheet and writing it to a netCDF file.
#
# [General] - python control parameters
# [Files] - contains paths, file names and location of data in file
# [Global] - global attributes to be written into the netCDF file
# [Variables] - data to extract from Excel spreadsheet and write to netCDF file
#
[General]
#InLevel = L1
#OutLevel = L1
Platform = PC    # Mac or PC

[Files]
    [[L1]]
        xlFilePath = D:/TERN/Sites/Calperum/Data/Processed/2011/               # path to Excel file
        xlFileName = Calperum_2011_L1.xls                                      # xl file name
        xlHeaderRow  = 2                                                       # row number of header row in xl file
        xl1stDataRow = 5                                                       # row number of first data row in xl file
        ncFilePath = D:/TERN/Sites/Calperum/Data/Processed/2011/               # path to netCDF file
        ncFileName = Calperum_2011_L1.nc                                       # nc file name

[Global]                                                                       # Global attributes for netCDF file
    SiteName = Calperum                                                        # Site name (no spaces) *required
    Site = "Alice Springs Mulga, Northern Territory, Australia"                # Site description *required
    Location = "Latitude: -30, Longitude: 135"                                 # Latitude and Longitude *required
    Institute = "University of Adelaide"                                       # Institute running site
    Contact  = timothy.lubcke@nowhere.com.au                                   # email address for contact *required
    TimeStep = 30                                                              # Timestep in minutes

[Variables]
# Date/time
    [[xlDateTime]]                                                             # netCDF variable name
        [[[xl]]]                                                               # Excel information section
            Sheet    = slow_met                                                # worksheet containing data
            Name     = TIMESTAMP                                               # name in Excel header row
        [[[Attr]]]                                                             # netCDF variable attribute section
            Description = "Date/time in Excel format"                          # variable attribute - description
            Units    = "days"                                                  # variable attribute - units
# Radiation: Kipp and Zonen CNR4
    [[Flu]]
        [[[xl]]]
            Sheet    = slow_rad
            Name     = Flu_CNR4_Avg
        [[[Attr]]]
            Description = "Up-welling long wave (Kipp&Zonen)"
            Units    = "W/m2"
    [[Fld]]
        [[[xl]]]
            Sheet    = slow_rad
            Name     = Fld_CNR4_Avg
        [[[Attr]]]
            Description = "Down-welling long wave (Kipp&Zonen)"
            Units    = "W/m2"
    [[Fsu]]
        [[[xl]]]
            Sheet    = slow_rad
            Name     = Fsu_CNR4_Avg
        [[[Attr]]]
            Description = "Up-welling short wave (Kipp&Zonen)"
            Units    = "W/m2"
    [[Fsd]]
        [[[xl]]]
            Sheet    = slow_rad
            Name     = Fsd_CNR4_Avg
        [[[Attr]]]
            Description = "Down-welling short wave (Kipp&Zonen)"
            Units    = "W/m2"
    [[Rs_CNR4]]
        [[[xl]]]
            Sheet    = slow_rad
            Name     = Rs_CNR4_Avg
        [[[Attr]]]
            Description = "Resistance of body temperature PT100 (Kipp&Zonen)"
            Units    = "ohms"
    [[Fsd_Li]]
        [[[xl]]]
            Sheet    = slow_extras
            Name     = SlrW_Avg
        [[[Attr]]]
            Description = "Down-welling short wave (Li-cor)"
            Units    = "W/m2"
# Covariances: Temperature
    [[UzT]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUzTv
        [[[Attr]]]
            Description = "Covariance of Uz and T (CSAT)"
            Units    = "mC/s"
    [[UxT]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUxTv
        [[[Attr]]]
            Description = "Covariance of Ux and T (CSAT)"
            Units    = "mC/s"
    [[UyT]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUyTv
        [[[Attr]]]
            Description = "Covariance of Uy and T (CSAT)"
            Units    = "mC/s"
# Covariances: H2O
    [[UzA]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUzAh
        [[[Attr]]]
            Description = "Covariance of w and H2O (7500)"
            Units    = "g/m2/s"
    [[UxA]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUxAh
        [[[Attr]]]
            Description = "Covariance of Ux and H2O (7500)"
            Units    = "g/m2/s"
    [[UyA]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUyAh
        [[[Attr]]]
            Description = "Covariance of Uy and H2O (7500)"
            Units    = "g/m2/s"
# Covariances: CO2
    [[UzC]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUzCc
        [[[Attr]]]
            Description = "Covariance of Uz and CO2 (7500)"
            Units    = "mg/m2/s"
    [[UxC]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUxCc
        [[[Attr]]]
            Description = "Covariance of Ux and CO2 (7500)"
            Units    = "mg/m2/s"
    [[UyC]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUyCc
        [[[Attr]]]
            Description = "Covariance of Uy and CO2 (7500)"
            Units    = "mg/m2/s"
# Covariances and variances: Momentum
    [[UxUz]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUzUx
        [[[Attr]]]
            Description = "Covariance of Ux and Uz"
            Units    = "m2/s2"
    [[UyUz]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUzUy
        [[[Attr]]]
            Description = "Covariance of Uy and Uz"
            Units    = "m2/s2"
    [[UxUy]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUxUy
        [[[Attr]]]
            Description = "Covariance of Ux and Uz"
            Units    = "m2/s2"
    [[UxUx]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUxUx
        [[[Attr]]]
            Description = "Variance of Ux"
            Units    = "m2/s2"
    [[UyUy]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covUyUy
        [[[Attr]]]
            Description = "Variance of Uy"
            Units    = "m2/s2"
# Meteorology: CSAT
    [[Tv_CSAT]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Tv_CSAT_Avg
        [[[Attr]]]
            Description = "Virtual air temperature (CSAT)"
            Units    = "C"
    [[Wd_CSAT]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = WD_CSAT_Compass_Avg
        [[[Attr]]]
            Description = "Wind direction (CSAT)"
            Units    = "deg"
    [[Ws_CSAT]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = WS_CSAT_Avg
        [[[Attr]]]
            Description = "Wind speed (CSAT)"
            Units    = "m/s"
    [[Ux]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Ux_CSAT_Avg
        [[[Attr]]]
            Description = "Ux (CSAT)"
            Units    = "m/s"
    [[Uy]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Uy_CSAT_Avg
        [[[Attr]]]
            Description = "Uy (CSAT)"
            Units    = "m/s"
    [[Uz]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Uz_CSAT_Avg
        [[[Attr]]]
            Description = "Uz (CSAT)"
            Units    = "m/s"
    [[Diag_CSAT]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = CSAT_Warn
        [[[Attr]]]
            Description = "CSAT diagnostic value"
            Units    = "none"
# Meteorology: LI-7500
    [[Ah_7500_Av]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Ah_7500_Avg
        [[[Attr]]]
            Description = "Absolute humidity (7500)"
            Units    = "g/m3"
    [[Cc_7500_Av]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Cc_7500_Avg
        [[[Attr]]]
            Description = "CO2 concentration (7500)"
            Units    = "mg/m3"
    [[AhAh]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covAhAh
        [[[Attr]]]
            Description = "Absolute humidity (7500), variance"
            Units    = "(g/m3)2"
    [[Ah_7500_Sd]]
        # Variance logged, need standard deviation for QC
        [[[Function]]]
            0          = "SquareRoot(ds.series['Ah_7500_Vr']['Data'])"
        [[[Attr]]]
            Description = "Absolute humidity (7500), standard deviation"
            Units    = "g/m3"
    [[CcCc]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = covCcCc
        [[[Attr]]]
            Description = "CO2 concentration (7500), variance"
            Units    = "(mg/m3)2"
    [[Cc_7500_Sd]]
        # Variance logged, need standard deviation for QC
        [[[Function]]]
            0          = "SquareRoot(ds.series['Cc_7500_Vr']['Data'])"
        [[[Attr]]]
            Description = "CO2 concentration (7500), standard deviation"
            Units    = "mg/m3"
    [[ps]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = ps_7500_Avg
        [[[Attr]]]
            Description = "Static pressure"
            Units    = "kPa"
    [[Diag_7500]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = 7500_Warn
        [[[Attr]]]
            Description = "7500 diagnostic value"
            Units    = "none"
    [[AGC_7500]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = AGC_7500_Avg
        [[[Attr]]]
            Description = "7500 AGC"
            Units    = "none"
# Meteorology: HMP45c
    [[Ah_HMP_01]]
        # Python QC expects one HMP to be labelled HMP_01
        [[[xl]]]
            Sheet    = slow_met
            Name     = Ah_HMP_01_Avg
        [[[Attr]]]
            Description = "Absolute humidity (HMP) at EC height"
            Units    = "g/m3"
    [[Ta_HMP_01]]
        # Python QC expects one HMP to be labelled HMP_01
        [[[xl]]]
            Sheet    = slow_met
            Name     = Ta_HMP_01_Avg
        [[[Attr]]]
            Description = "Air temperature (HMP) at EC height"
            Units    = "C"
# Meteorology: RMYoung
    [[Ws_RMY_2m]]
        [[[xl]]]
            Sheet    = slow_extras
            Name     = Wind_speed_m/s@2m
        [[[Attr]]]
            Description = "Wind speed (RMY) at 2m"
            Units    = "m/s"
    [[Wd_RMY_2m]]
        [[[xl]]]
            Sheet    = slow_extras
            Name     = Wind_Dir_mean@2m
        [[[Attr]]]
            Description = "Wind direction (RMY) at 2m"
            Units    = "deg"
    [[Ws_RMY_10m]]
        [[[xl]]]
            Sheet    = slow_extras
            Name     = Wind_speed_m/s@10m
        [[[Attr]]]
            Description = "Wind speed (RMY) at 10m"
            Units    = "m/s"
    [[Wd_RMY_10m]]
        [[[xl]]]
            Sheet    = slow_extras
            Name     = Wind_Dir_mean@10m
        [[[Attr]]]
            Description = "Wind direction (RMY) at 10m"
            Units    = "deg"
# Meteorology: Rain
    [[Rain]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Rain_Tot
        [[[Attr]]]
            Description = "Rainfall"
            Units    = "mm"
# Soil: Ground heat flux
    [[Fg_01]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = Fg_HFP01_01_Avg
        [[[Attr]]]
            Description = "Ground heat flux"
            Units    = "W/m2"
    [[Fg_02]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = Fg_HFP01_02_Avg
        [[[Attr]]]
            Description = "Ground heat flux"
            Units    = "W/m2"
    [[Fg_03]]
        [[[xl]]]
            Sheet    = slow_flux
            Name     = Fg_HFP01_03_Avg
        [[[Attr]]]
            Description = "Ground heat flux"
            Units    = "W/m2"
# Soil: Soil moisture
    [[Sws_01]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_01_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_02]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_02_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_03]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_03_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_04]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_04_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_05]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_05_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_06]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_06_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_07]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_07_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_08]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_08_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_09]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_09_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_10]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_10_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_11]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_11_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_12]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_12_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_13]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_13_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_14]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_14_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_15]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_15_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
    [[Sws_16]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Sws_616_16_Avg
        [[[Attr]]]
            Description = "Soil water fraction"
            Units    = "frac"
# Soil: Soil temperature
    [[Ts_01]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Ts_TCAV_01_Avg
        [[[Attr]]]
            Description = "Soil temperature"
            Units    = "C"
    [[Ts_02]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Ts_TCAV_02_Avg
        [[[Attr]]]
            Description = "Soil temperature"
            Units    = "C"
    [[Ts_03]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Ts_TCAV_03_Avg
        [[[Attr]]]
            Description = "Soil temperature"
            Units    = "C"
# Housekeeping
    [[Vbat]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Vbat_Avg
        [[[Attr]]]
            Description = "Battery voltage"
            Units    = "V"
    [[Tpanel]]
        [[[xl]]]
            Sheet    = slow_met
            Name     = Tpanel_Avg
        [[[Attr]]]
            Description = "Panel temperature"
            Units    = "C"

